"use strict";(self.webpackChunkpaulohernane_me=self.webpackChunkpaulohernane_me||[]).push([[9344],{1180:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var a=t(4848),r=t(5680);const i={id:"feature-engineering-and-selection",title:"Feature Engineering and Selection",tags:["machine-learning","feature-engineering","feature-selection","data-preprocessing"]},o=void 0,c={id:"machine-learning-and-data-science-course/feature-engineering-and-selection",title:"Feature Engineering and Selection",description:"It's note true that more atributtes will make a model better.",source:"@site/my-brain/machine-learning-and-data-science-course/feature-engineering-and-selection.md",sourceDirName:"machine-learning-and-data-science-course",slug:"/machine-learning-and-data-science-course/feature-engineering-and-selection",permalink:"/my-brain/machine-learning-and-data-science-course/feature-engineering-and-selection",draft:!1,unlisted:!1,tags:[{label:"machine-learning",permalink:"/my-brain/tags/machine-learning"},{label:"feature-engineering",permalink:"/my-brain/tags/feature-engineering"},{label:"feature-selection",permalink:"/my-brain/tags/feature-selection"},{label:"data-preprocessing",permalink:"/my-brain/tags/data-preprocessing"}],version:"current",frontMatter:{id:"feature-engineering-and-selection",title:"Feature Engineering and Selection",tags:["machine-learning","feature-engineering","feature-selection","data-preprocessing"]},sidebar:"myBrainSidebar",previous:{title:"Dimensionality Reduction",permalink:"/my-brain/machine-learning-and-data-science-course/dimensionality-reduction"},next:{title:"Model Validation",permalink:"/my-brain/machine-learning-and-data-science-course/model-validation"}},s={},l=[{value:"Low variance",id:"low-variance",level:2},{value:"High correlation",id:"high-correlation",level:2},{value:"Extra tree",id:"extra-tree",level:2}];function d(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,r.RP)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"It's note true that more atributtes will make a model better.\nSo we need to select the best features to use in our model."}),"\n",(0,a.jsx)(n.h2,{id:"low-variance",children:"Low variance"}),"\n",(0,a.jsx)(n.p,{children:"Variance is a measure of how much the value is spread out (has a large range).\nIf a feature has a low variance, it means that the values are very similar."}),"\n",(0,a.jsxs)(n.p,{children:["We can use the ",(0,a.jsx)(n.code,{children:"VarianceThreshold"})," class from ",(0,a.jsx)(n.code,{children:"sklearn.feature_selection"})," to remove features with low variance."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from sklearn.feature_selection import VarianceThreshold\n\n# Create a VarianceThreshold object\nselector = VarianceThreshold(threshold=0.2)\n\n# Fit the object to the data\nselector.fit(data)\n\n# Get the indices of the features that are being kept\nkept_indices = selector.get_support(indices=True)\n\n# Get the names of the features that are being kept\nkept_features = data.columns[kept_indices]\n\n# Transform the data to only keep the selected features\ndata_selected = selector.transform(data)\n"})}),"\n",(0,a.jsxs)(n.p,{children:["To get the threshold value, we can use the ",(0,a.jsx)(n.code,{children:"np.var"})," function from NumPy to calculate the variance of each feature."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# Calculate the variance of each feature\nvariances = np.var(data, axis=0) # axis=0 calculates the variance of each column\n\n# Get the names of the features with low variance\nlow_variance_features = data.columns[variances < 0.2]\n"})}),"\n",(0,a.jsx)(n.h2,{id:"high-correlation",children:"High correlation"}),"\n",(0,a.jsx)(n.p,{children:"Correlation is a measure of how much two variables change together.\nIf two features are highly correlated, they may contain redundant information."}),"\n",(0,a.jsxs)(n.p,{children:["We can use the ",(0,a.jsx)(n.code,{children:"corr"})," method from a pandas DataFrame to calculate the correlation between features."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"# Calculate the correlation matrix\ncorrelation_matrix = data.corr()\n\n# Get the indices of the features that are highly correlated\nhighly_correlated_indices = np.where(np.abs(correlation_matrix) > 0.8)\n\n# Get the names of the features that are highly correlated\nhighly_correlated_features = data.columns[highly_correlated_indices]\n"})}),"\n",(0,a.jsx)(n.h2,{id:"extra-tree",children:"Extra tree"}),"\n",(0,a.jsx)(n.p,{children:"Extra Trees is an ensemble learning method that fits multiple decision trees to the data and averages the predictions.\nThis uses the Extra Trees not for classification or regression, but to calculate the feature importance."}),"\n",(0,a.jsxs)(n.p,{children:["We can use the ",(0,a.jsx)(n.code,{children:"ExtraTreesClassifier"})," and ",(0,a.jsx)(n.code,{children:"ExtraTreesRegressor"})," classes from ",(0,a.jsx)(n.code,{children:"sklearn.ensemble"})," to calculate the feature importance."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"from sklearn.ensemble import ExtraTreesClassifier\n\n# Split the data into training and testing sets\ndata = df.drop('target', axis=1) # axis=1 drops the 'target' column\ntarget = df['target']\n\n# Create an ExtraTreesClassifier object\nmodel = ExtraTreesClassifier(criterion='gini', random_state=42)\n\n# Fit the model to the data\nmodel.fit(data, target)\n\n# Get the feature importances\nfeature_importances = model.feature_importances_\n\n# Drop the features with low importance\ndata_selected = data.drop(data.columns[feature_importances < 0.1], axis=1)\n\n# Get the names of the features with low importance\nlow_importance_features = data.columns[feature_importances < 0.1]\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.RP)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},5680:(e,n,t)=>{t.d(n,{RP:()=>l});var a=t(6540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),l=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},h=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,h=c(e,["components","mdxType","originalType","parentName"]),u=l(t),m=r,f=u["".concat(s,".").concat(m)]||u[m]||d[m]||i;return t?a.createElement(f,o(o({ref:n},h),{},{components:t})):a.createElement(f,o({ref:n},h))}));h.displayName="MDXCreateElement"}}]);