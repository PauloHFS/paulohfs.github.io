"use strict";(self.webpackChunkpaulohernane_me=self.webpackChunkpaulohernane_me||[]).push([[4646],{6703:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var i=r(4848),t=r(5680);const o={id:"classical-synchronization-problems",title:"Classical Synchronization Problems",tags:["Concurrent Programming","Synchronization Patterns"]},a="Classical Synchronization Problems",s={id:"concurrent-programming/classical-synchronization-problems",title:"Classical Synchronization Problems",description:"Producer-Consumer Problem",source:"@site/my-brain/concurrent-programming/classical-synchronization-problems.md",sourceDirName:"concurrent-programming",slug:"/concurrent-programming/classical-synchronization-problems",permalink:"/my-brain/concurrent-programming/classical-synchronization-problems",draft:!1,unlisted:!1,tags:[{label:"Concurrent Programming",permalink:"/my-brain/tags/concurrent-programming"},{label:"Synchronization Patterns",permalink:"/my-brain/tags/synchronization-patterns"}],version:"current",frontMatter:{id:"classical-synchronization-problems",title:"Classical Synchronization Problems",tags:["Concurrent Programming","Synchronization Patterns"]},sidebar:"myBrainSidebar",previous:{title:"Basic Synchronization Patterns",permalink:"/my-brain/concurrent-programming/basic-synchronization-patterns"},next:{title:"Concurrency vs Parallelism",permalink:"/my-brain/concurrent-programming/concurrency-vs-parallelism"}},l={},c=[{value:"Producer-Consumer Problem",id:"producer-consumer-problem",level:2},{value:"Solving using Semaphores",id:"solving-using-semaphores",level:3},{value:"Solving using Conditional Variable",id:"solving-using-conditional-variable",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",pre:"pre",...(0,t.RP)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"classical-synchronization-problems",children:"Classical Synchronization Problems"}),"\n",(0,i.jsx)(n.h2,{id:"producer-consumer-problem",children:"Producer-Consumer Problem"}),"\n",(0,i.jsx)(n.h3,{id:"solving-using-semaphores",children:"Solving using Semaphores"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"# main\nMAX_SIZE = 2 # buffer size\n\nclass Buffer:\n    def __init__(self, size):\n        self.buffer = [None for _ in range(size)]\n        self.size = size\n        self.fill = 0\n        self.use = 0\n        self.mutex = Semaphore(1)\n        # TEST if using 1 or 2 semaphores is better\n\n    def put(v):\n        self.mutex.wait()\n        self.buffer[self.fill] = v\n        self.fill = (self.fill + 1) % self.size\n        self.mutex.signal()\n\n    def get():\n        self.mutex.wait()\n        v = self.buffer[self.use]\n        self.use = (self.use + 1) % self.size\n        self.mutex.signal()\n        return v\n\nbuffer = Buffer(MAX_SIZE)\nproducerDone = Semaphore(0)\nconsumerDone = Semaphore(MAX_SIZE)\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"# Thread A\n\ndef producer():\n    for i in range(0, 100):\n        consumerDone.wait()\n        buffer.put(i)\n        producerDone.signal()\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:"# Thread B\n\ndef consumer():\n    for i in range(0, 100):\n        producerDone.wait()\n        v = buffer.get()\n        print(v)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"solving-using-conditional-variable",children:"Solving using Conditional Variable"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"// main\n\nint *buffer;\nmutex_t buffer_mutex;\ncond_t fill;\ncond_t empty\n\nsem_init(&buffer_mutex, 1);\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"// Producer\n\nfor (int i; i < 100; i++) {\n    mutex_lock(&buffer_mutex) \n    while (buffer_is_full(&buffer) {\n        cond_wait(&empty, &buffer_mutex) \n    }\n    put(&buffer, i) \n    cond_signal(&fill)  \n    mutex_unlock(&buffer_mutex) \n}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"// Consumer\n\nfor (int i; i < 100; i++) {\n    mutex_lock(&buffer_mutex) \n    while (buffer_is_empty(&buffer) {\n        cond_wait(&fill, &buffer_mutex) \n    }\n    take(&buffer)\n    cond_signal(&empty)\n    mutex_unlock(&buffer_mutex)\n}\n"})})]})}function m(e={}){const{wrapper:n}={...(0,t.RP)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},5680:(e,n,r)=>{r.d(n,{RP:()=>c});var i=r(6540);function t(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,i)}return r}function a(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){t(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function s(e,n){if(null==e)return{};var r,i,t=function(e,n){if(null==e)return{};var r,i,t={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],n.indexOf(r)>=0||(t[r]=e[r]);return t}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}var l=i.createContext({}),c=function(e){var n=i.useContext(l),r=n;return e&&(r="function"==typeof e?e(n):a(a({},n),e)),r},u={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},m=i.forwardRef((function(e,n){var r=e.components,t=e.mdxType,o=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),f=c(r),p=t,d=f["".concat(l,".").concat(p)]||f[p]||u[p]||o;return r?i.createElement(d,a(a({ref:n},m),{},{components:r})):i.createElement(d,a({ref:n},m))}));m.displayName="MDXCreateElement"}}]);